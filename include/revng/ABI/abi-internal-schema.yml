#
# This file is distributed under the MIT License. See LICENSE.md for details.
#

version: 1
root_type: Definition
definitions:
  - name: Definition
    type: struct
    doc: for the documentation see `references/abi-definition.md`
    fields:
      - name: ABI
        type: model::ABI::Values

      - name: ArgumentsArePositionBased
        type: bool
        default: false

      - name: OnlyStartDoubleArgumentsFromAnEvenRegister
        type: bool
        default: false
      - name: ArgumentsCanBeSplitBetweenRegistersAndStack
        type: bool
        default: false
      - name: BigArgumentsUsePointersToCopy
        type: bool
        default: false
      - name: NoRegisterArgumentsCanComeAfterStackOnes
        type: bool
        default: false
      - name: AllowPackedTypesInRegisters
        type: bool
        default: false
      - name: CalleeIsResponsibleForStackCleanup
        type: bool
        default: false
      - name: FloatsUseGPRs
        type: bool
        default: false
      - name: PackStackArguments
        type: bool
        default: false
      - name: TreatAllAggregatesAsPacked
        type: bool
        default: false

      - name: StackAlignment
        type: uint64_t
        default: -1
      - name: MinimumStackArgumentSize
        type: uint64_t
        default: -1
      - name: UnusedStackArgumentBytes
        type: uint64_t
        default: 0

      - name: MaximumGPRsPerAggregateArgument
        type: uint64_t
        default: 0
      - name: MaximumGPRsPerAggregateReturnValue
        type: uint64_t
        default: 0
      - name: MaximumGPRsPerScalarArgument
        type: uint64_t
        default: 0
      - name: MaximumGPRsPerScalarReturnValue
        type: uint64_t
        default: 0

      - name: GeneralPurposeArgumentRegisters
        sequence:
          type: std::vector
          elementType: model::Register::Values
      - name: GeneralPurposeReturnValueRegisters
        sequence:
          type: std::vector
          elementType: model::Register::Values
      - name: VectorArgumentRegisters
        sequence:
          type: std::vector
          elementType: model::Register::Values
      - name: VectorReturnValueRegisters
        sequence:
          type: std::vector
          elementType: model::Register::Values
      - name: CalleeSavedRegisters
        sequence:
          type: std::vector
          elementType: model::Register::Values

      - name: ReturnValueLocationRegister
        type: model::Register::Values
      - name: ReturnValueLocationOnStack
        type: bool
        default: false
      - name: ReturnValueLocationIsReturned
        type: bool
        default: false

      - name: ScalarTypes
        sequence:
          type: SortedVector
          elementType: ScalarType

      - name: FloatingPointScalarTypes
        sequence:
          type: SortedVector
          elementType: ScalarType

    key:
      - ABI

  - name: ScalarType
    type: struct
    doc: |
      Represents type specific information ABI needs to be aware of,
      for example, alignment.
    fields:
      - name: Size
        type: uint64_t
        default: -1

      - name: AlignedAt
        doc: |
          When set to `0`, the alignment of this type matches its size.
        type: uint64_t
        default: 0

    key:
      - Size
